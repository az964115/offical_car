<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>æ‚…åŸå…¬å‹™è»Šé ç´„ç³»çµ± - 2025 æ–°ç‰ˆ</title>

    <script type="module">
        let isAdmin = false;
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
        import { getDatabase, ref, set, push, onValue, remove, get } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBcih7IhI_Leas5CWCG_v2ZIljtHKqahMY",
            authDomain: "onano-10788.firebaseapp.com",
            databaseURL: "https://onano-10788-default-rtdb.asia-southeast1.firebasedatabase.app/",
            projectId: "onano-10788",
            storageBucket: "onano-10788.firebasestorage.app",
            messagingSenderId: "180832735179",
            appId: "1:180832735179:web:7abceadc7f4dede11bf04e",
            measurementId: "G-0XH3GH7JJB"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const recordsRef = ref(db, 'records');

        const users = [
            "é„­å­Ÿç‘¤","ç‹æ¸…é´»","ç•™ç‘è“®","ç”°å¤ç›Š","é‚±æ–‡è°","æå®¶ç¶­","è¨±å®¶è±ª","ææ»‹èŠ³","ç§¦åœ‹å³°","åŠ‰ä¿Šå½¥","è”¡åœ‹ä»","å» å•†","å…¶ä»–","ç®¡ç†è€…"
        ];

        const cars = [
            "4351-M5",
            "4351-M5-Test"
        ];

        let finalSelectedUser = "";
        let finalStartTime = null;
        let finalEndTime = null;

        function applyCustomUserAndTime() {
            const dropdownUser = document.getElementById("userSelect").value;
            const customName = document.getElementById("customUserInput").value.trim();

            const selectedYear = document.getElementById("yearSelect").value;
            const month = document.getElementById("monthSelect").value;
            const day = document.getElementById("daySelect").value;
            const startHour = document.getElementById("startHour").value;
            const startMinute = document.getElementById("startMinute").value;
            const endHour = document.getElementById("endHour").value;
            const endMinute = document.getElementById("endMinute").value;

            if (dropdownUser === "å…¶ä»–") {
                if (!customName) {
                    alert("è«‹è¼¸å…¥åç¨±ï¼Œä¾‹å¦‚ï¼šç‹å¤§æ˜");
                    return;
                }
            } else {
                if (!dropdownUser || dropdownUser === "") {
                    alert("è«‹é¸æ“‡ä½¿ç”¨è€…åç¨±");
                    return;
                }
            }

            const user = dropdownUser === "å…¶ä»–" ? customName : dropdownUser;
            finalStartTime = new Date(selectedYear, month - 1, day, startHour, startMinute);
            finalEndTime   = new Date(selectedYear, month - 1, day, endHour, endMinute);

            finalSelectedUser = user;

            if (!selectedYear || !month || !day || !startHour || !startMinute || !endHour || !endMinute) {
                alert("è«‹å®Œæ•´é¸æ“‡æ™‚é–“ï¼ˆå¹´ä»½ã€æœˆä»½ã€æ—¥æœŸã€é–‹å§‹æ™‚é–“ã€çµæŸæ™‚é–“ï¼‰");
                return;
            }

            const displayInfo = `${user} - ${selectedYear}/${month.padStart(2,'0')}/${day.padStart(2,'0')} ${startHour}:${startMinute} ~ ${endHour}:${endMinute}`;
            localStorage.setItem("selectedUser", finalSelectedUser);
            document.getElementById("currentUserInfo").textContent = `å·²å¥—ç”¨ä½¿ç”¨è€…ï¼š${displayInfo}`;
            document.getElementById("currentUserInfo").style.color = "green";
            alert('âœ… å·²å¥—ç”¨ï¼š' + displayInfo);
        }
        window.applyCustomUserAndTime = applyCustomUserAndTime;

        // --- Reserve a car (stores under /carReservations) ---
        function reserveCar() {
            if (!finalSelectedUser || !finalStartTime || !finalEndTime) {
                alert("è«‹å…ˆå¥—ç”¨ä½¿ç”¨è€…èˆ‡æ™‚é–“ï¼ˆé»ã€Œå¥—ç”¨ã€ï¼‰å†é ç´„è½è»Šã€‚");
                return;
            }
            const carId = document.getElementById("carSelect").value;
            if (!carId) {
                alert("è«‹é¸æ“‡è½è»Šç·¨è™Ÿ");
                return;
            }

            // create reservation object
            const res = {
                carId: carId,
                user: finalSelectedUser,
                startTime: finalStartTime.toISOString(),
                endTime: finalEndTime.toISOString(),
                createdAt: new Date().toISOString()
            };

            // use push to create unique id
            push(ref(db, 'carReservations'), res)
            .then(() => {
                alert("âœ… å·²é ç´„è½è»Šï¼š" + carId);
                loadCarReservations();
            })
            .catch(err => {
                alert("é ç´„å¤±æ•—ï¼š" + err);
            });
        }
        window.reserveCar = reserveCar;

        function loadCarReservations() {
            const listElem = document.getElementById("carReservationsList");
            if (!listElem) return;
            listElem.innerHTML = '';

            const carRef = ref(db, 'carReservations');
            onValue(carRef, snapshot => {
                const data = snapshot.val();
                listElem.innerHTML = '';
                if (!data) return;

                // sort by startTime ascending
                const sorted = Object.entries(data).sort((a,b) => {
                    return new Date(a[1].startTime) - new Date(b[1].startTime);
                });

                sorted.forEach(([key, r]) => {
                    const li = document.createElement('li');
                    const start = new Date(r.startTime);
                    const end = new Date(r.endTime);
                    const startStr = start.toLocaleString('zh-TW', { hour12:false, year:'numeric', month:'2-digit', day:'2-digit', hour:'2-digit', minute:'2-digit' });
                    const endStr   = end.toLocaleString('zh-TW',   { hour12:false, year:'numeric', month:'2-digit', day:'2-digit', hour:'2-digit', minute:'2-digit' });

                    li.textContent = `${r.carId} - ${r.user} - ${startStr} ~ ${endStr}`;

                    // admin delete
                    const del = document.createElement('button');
                    del.textContent = 'åˆªé™¤';
                    del.style.marginLeft = '8px';
                    del.onclick = () => {
                        if (!isAdmin) {
                            alert('åƒ…ç®¡ç†è€…å¯åˆªé™¤é ç´„ï¼ˆè«‹åˆ‡æ›ç‚ºç®¡ç†è€…ï¼‰');
                            return;
                        }
                        const pw = prompt('è¼¸å…¥ç®¡ç†è€…å¯†ç¢¼ä»¥åˆªé™¤ï¼š');
                        if (pw === 'Onano_Nb') {
                            remove(ref(db, 'carReservations/' + key))
                            .then(()=> { alert('å·²åˆªé™¤'); })
                            .catch(err=> alert('åˆªé™¤å¤±æ•—:' + err));
                        } else {
                            alert('å¯†ç¢¼éŒ¯èª¤');
                        }
                    };
                    li.appendChild(del);
                    listElem.appendChild(li);
                });
            });
        }
        window.loadCarReservations = loadCarReservations;

        // integrate car reservations into monitor: when startTime reached, mark car cell red (if exists)
        function monitorCarReservations() {
            setInterval(() => {
                const now = new Date();
                get(ref(db, 'carReservations')).then(snapshot => {
                    const data = snapshot.val();
                    if (!data) return;
                    Object.entries(data).forEach(([key, r]) => {
                        const start = new Date(r.startTime);
                        const end = new Date(r.endTime);
                        const carId = r.carId;
                        const carCell = document.getElementById(carId);
                        // if a corresponding cell exists on page
                        if (now >= start && now < end && carCell && carCell.classList.contains('green')) {
                            carCell.classList.remove('green'); carCell.classList.add('red');
                            carCell.textContent = `${carId} - ${r.user} - ${new Date(r.startTime).toLocaleString()} ~ ${new Date(r.endTime).toLocaleString()}`;
                            // write to DB color state for persistence
                            set(ref(db, `carStatus/${carId}`), { color: 'red', user: r.user, startTime: r.startTime, endTime: r.endTime });
                            push(recordsRef, { id: carId, action: 'ä½¿ç”¨ä¸­ï¼ˆé ç´„è‡ªå‹•ï¼‰', user: r.user, startTime: r.startTime, endTime: r.endTime, time: new Date().toISOString() });
                        }
                        if (now >= end && carCell && carCell.classList.contains('red')) {
                            carCell.classList.remove('red'); carCell.classList.add('green');
                            carCell.textContent = carId;
                            set(ref(db, `carStatus/${carId}`), { color: 'green' });
                            push(recordsRef, { id: carId, action: 'ç©ºé–’ï¼ˆé ç´„è‡ªå‹•ï¼‰', user: r.user, startTime: r.startTime, endTime: r.endTime, time: new Date().toISOString() });
                            remove(ref(db, 'carReservations/' + key));
                        }
                    });
                });
            }, 10000);
        }

        // --- UI helpers (populate selectors, update block/room status) ---
        function populateTimeSelectors() {
            const startHour = document.getElementById("startHour");
            const startMinute = document.getElementById("startMinute");
            const endHour = document.getElementById("endHour");
            const endMinute = document.getElementById("endMinute");

            [startHour, startMinute, endHour, endMinute].forEach(select => {
                if (select) select.innerHTML = '';
            });

            for (let h = 8; h < 20; h++) {
                const hStr = h.toString().padStart(2,'0');
                startHour.appendChild(new Option(hStr, hStr));
                endHour.appendChild(new Option(hStr, hStr));
            }
            for (let m = 0; m < 60; m++) {
                const mStr = m.toString().padStart(2,'0');
                startMinute.appendChild(new Option(mStr, mStr));
                endMinute.appendChild(new Option(mStr, mStr));
            }

            const yearSelect = document.getElementById("yearSelect");
            const monthSelect = document.getElementById("monthSelect");
            const daySelect = document.getElementById("daySelect");
            yearSelect.innerHTML = '';
            monthSelect.innerHTML = '';
            daySelect.innerHTML = '';
            const now = new Date();
            for (let y = now.getFullYear(); y <= now.getFullYear()+3; y++) {
                yearSelect.appendChild(new Option(y.toString(), y.toString()));
            }
            for (let m = 1; m <= 12; m++) monthSelect.appendChild(new Option(String(m).padStart(2,'0'), String(m).padStart(2,'0')));
            for (let d = 1; d <= 31; d++) daySelect.appendChild(new Option(String(d).padStart(2,'0'), String(d).padStart(2,'0')));
        }

        // toggle cell (existing rooms/cars) - uses finalSelectedUser/time
        function toggleColor(element) {
            const id = element.id;
            if (!finalSelectedUser || !finalStartTime || !finalEndTime) {
                alert("è«‹å…ˆå¥—ç”¨ä½¿ç”¨è€…åç¨±èˆ‡æ™‚é–“ï¼ï¼ˆé»ã€Œå¥—ç”¨ã€ï¼‰");
                return;
            }

            const colorRef = ref(db, id);

            if (element.classList.contains('green')) {
                element.classList.remove('green'); element.classList.add('red');
                element.textContent = `${id} - ${finalSelectedUser} - ${finalStartTime.toLocaleString('zh-TW')} ~ ${finalEndTime.toLocaleString('zh-TW')}`;

                const newRecord = {
                    id: id,
                    action: 'ä½¿ç”¨ä¸­',
                    user: finalSelectedUser,
                    startTime: finalStartTime.toISOString(),
                    endTime: finalEndTime.toISOString(),
                    time: new Date().toISOString()
                };

                set(colorRef, {
                    color: 'red',
                    user: finalSelectedUser,
                    startTime: finalStartTime.toISOString(),
                    endTime: finalEndTime.toISOString()
                });
                push(recordsRef, newRecord);
            } else if (element.classList.contains('red')) {
                element.classList.remove('red'); element.classList.add('green');
                element.textContent = id;
                set(colorRef, { color: 'green' });
                push(recordsRef, {
                    id: id,
                    action: 'ç©ºé–’',
                    user: finalSelectedUser,
                    startTime: finalStartTime ? finalStartTime.toISOString() : null,
                    endTime: finalEndTime ? finalEndTime.toISOString() : null,
                    time: new Date().toISOString()
                });
            }
        }
        window.toggleColor = toggleColor;

        // update block status for both rooms and cars based on DB paths
        function updateBlockStatus() {
            const allCells = document.querySelectorAll('td[data-type]');
            allCells.forEach(cell => {
                const id = cell.id;
                const type = cell.getAttribute('data-type'); // 'room' or 'car'
                const colorRef = type === 'car' ? ref(db, `carStatus/${id}`) : ref(db, id);
                onValue(colorRef, (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        cell.classList.remove('green','red');
                        cell.classList.add(data.color);
                        if (data.color === 'red') {
                            const start = data.startTime ? new Date(data.startTime).toLocaleString('zh-TW') : '';
                            const end = data.endTime ? new Date(data.endTime).toLocaleString('zh-TW') : '';
                            cell.textContent = `${id} - ${data.user || ''} ${start ? (' - ' + start + ' ~ ' + end) : ''}`;
                        } else {
                            cell.textContent = id;
                        }
                    } else {
                        cell.classList.remove('green','red');
                        cell.classList.add('green');
                        cell.textContent = id;
                    }
                });
            });
        }

        // show records (keeps original behavior)
        function showRecords() {
            const recordList = document.getElementById("recordList");
            const carNumberInput = document.getElementById("carNumberInput");
            const userSelect = document.getElementById("userSelect");
            const selectedUser = userSelect.value;

            const carNumber = carNumberInput.value.trim().toLowerCase();

            onValue(recordsRef, (snapshot) => {
                const records = snapshot.val();
                if (!records) {
                    recordList.innerHTML = '';
                    return;
                }

                const filtered = Object.entries(records).filter(([k, record]) => {
                    const isCarMatch = carNumber === "" || record.id.toLowerCase().includes(carNumber);
                    const isUserMatch = selectedUser === "ç®¡ç†è€…" || record.user === selectedUser;
                    return isCarMatch && isUserMatch;
                }).reverse();

                recordList.innerHTML = '';
                filtered.forEach(([k, rec]) => {
                    const li = document.createElement('li');
                    const recordTime = new Date(rec.time);
                    const localTime = recordTime.toLocaleString('zh-TW', { hour12:false, year:'numeric', month:'2-digit', day:'2-digit', hour:'2-digit', minute:'2-digit', second:'2-digit' });
                    li.textContent = `${rec.id} - ${rec.action} - ${rec.user} - ${rec.startTime ? new Date(rec.startTime).toLocaleString('zh-TW') : 'æœªè¨­å®š'} ~ ${rec.endTime ? new Date(rec.endTime).toLocaleString('zh-TW') : 'æœªè¨­å®š'} - æ“ä½œæ™‚é–“: ${localTime}`;
                    const del = document.createElement('button');
                    del.textContent = 'åˆªé™¤';
                    del.onclick = () => {
                        const pw = prompt('è«‹è¼¸å…¥å¯†ç¢¼ä»¥åˆªé™¤ç´€éŒ„:');
                        if (pw === 'Onano_Nb') {
                            remove(ref(db, 'records/' + k)).then(()=> { alert('å·²åˆªé™¤'); showRecords();});
                        } else alert('å¯†ç¢¼éŒ¯èª¤');
                    };
                    li.appendChild(del);
                    recordList.appendChild(li);
                });
            });
        }
        window.showRecords = showRecords;

        // --- download current page as HTML (client-side) ---
        function downloadCurrentHTML() {
            const html = document.documentElement.outerHTML;
            const blob = new Blob([html], {type: 'text/html'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'æ‚…åŸå…¬å‹™è»Šé ç´„ç³»çµ±_åŒ¯å‡º.html';
            document.body.appendChild(a);
            a.click();
            a.remove();
            URL.revokeObjectURL(url);
        }
        window.downloadCurrentHTML = downloadCurrentHTML;

        // --- startup ---
        window.onload = function() {
            const userSelect = document.getElementById("userSelect");
            users.forEach(u => {
                const opt = document.createElement('option');
                opt.value = u; opt.textContent = u;
                userSelect.appendChild(opt);
            });

            // populate cars dropdown
            const carSelect = document.getElementById('carSelect');
            cars.forEach(c => {
                const opt = document.createElement('option');
                opt.value = c; opt.textContent = c;
                carSelect.appendChild(opt);
            });

            populateTimeSelectors();

            const savedUser = localStorage.getItem('selectedUser');
            if (savedUser) document.getElementById('currentUserInfo').textContent = `å·²å¥—ç”¨ï¼š${savedUser}`;

            const customInput = document.getElementById("customUserInput");
            customInput.disabled = true;
            userSelect.addEventListener('change', (e) => {
                const selectedUser = e.target.value;
                if (selectedUser === 'ç®¡ç†è€…') {
                    const password = prompt('è«‹è¼¸å…¥å¯†ç¢¼ä»¥é¸æ“‡ç®¡ç†è€…:');
                    if (password === 'Onano_Nb') {
                        localStorage.setItem('selectedUser', selectedUser);
                        isAdmin = true;
                        e.target.value = 'ç®¡ç†è€…';
                    } else {
                        alert('å¯†ç¢¼éŒ¯èª¤ï¼');
                        e.target.value = '';
                        isAdmin = false;
                    }
                } else {
                    localStorage.setItem('selectedUser', selectedUser);
                    isAdmin = false;
                }

                if (selectedUser === 'å…¶ä»–') {
                    customInput.disabled = false;
                    customInput.focus();
                } else {
                    customInput.disabled = true; customInput.value = '';
                }
            });

            updateBlockStatus();
            loadCarReservations();
            loadFutureReservations(); // kept from original file (futureReservations for rooms)
            monitorCarReservations();
            monitorFutureReservations(); // from original file to monitor room futureReservations

            setInterval(displayDateTime, 1000);
        };

        // --- the rest of original functions kept with minimal edits: future reservations for rooms ---
        function reserveForFuture() {
            if (!finalSelectedUser || !finalEndTime) {
                alert("è«‹å…ˆå¥—ç”¨ä½¿ç”¨è€…èˆ‡æ™‚é–“ï¼é»æ“Šé ç´„å¾Œæœƒè·‘åˆ°ä¸Šæ–¹é ç´„è™•ï¼Œä¸ç”¨å†åˆ°ä¸‹æ–¹æ‰‹å‹•é»æ“Šæ ¼å­");
                return;
            }

            const roomId = prompt("è«‹è¼¸å…¥è¦é ç´„çš„æœƒè­°å®¤ç·¨è™Ÿï¼ˆä¾‹å¦‚ï¼š102ï¼‰ï¼š");
            if (!roomId || !document.getElementById(roomId)) {
                alert("ç„¡æ•ˆçš„æœƒè­°å®¤ ID");
                return;
            }

            const selectedYear = document.getElementById("yearSelect").value;
            const month = document.getElementById("monthSelect").value;
            const day = document.getElementById("daySelect").value;
            const startHour = document.getElementById("startHour").value;
            const startMinute = document.getElementById("startMinute").value;
            const endHour = document.getElementById("endHour").value;
            const endMinute = document.getElementById("endMinute").value;

            const formattedStartTime = `${selectedYear}/${month.toString().padStart(2, '0')}/${day.toString().padStart(2, '0')} ${startHour}:${startMinute}`;
            const formattedEndTime   = `${selectedYear}/${month.toString().padStart(2, '0')}/${day.toString().padStart(2, '0')} ${endHour}:${endMinute}`;

            const reservationData = {
                roomId: roomId,
                user: finalSelectedUser,
                startTime: formattedStartTime,
                endTime: formattedEndTime,
            };

            const futureRef = ref(db, `futureReservations/${roomId}_${new Date(selectedYear, month - 1, day, startHour, startMinute).getTime()}`);
            set(futureRef, reservationData)
                .then(() => {
                    alert("âœ… å·²é ç´„æˆåŠŸï¼");
                    loadFutureReservations();
                })
                .catch(err => {
                    alert("é ç´„å¤±æ•—ï¼š" + err);
                });
        }
        window.reserveForFuture = reserveForFuture;

        function loadFutureReservations() {
            const listElem = document.getElementById("futureReservationsList");
            if (!listElem) return;
            listElem.innerHTML = "";

            const futureRef = ref(db, 'futureReservations');
            onValue(futureRef, snapshot => {
                const data = snapshot.val();
                if (!data) return;

                const sorted = Object.entries(data).sort((a, b) => {
                    return new Date(a[1].startTime) - new Date(b[1].startTime);
                });

                sorted.forEach(([key, res]) => {
                    const li = document.createElement("li");
                    li.textContent = `æœƒè­°å®¤${res.roomId} - ${res.user} - ${res.startTime} ~ ${res.endTime}`;
                    if (isAdmin) {
                        const deleteBtn = document.createElement("button");
                        deleteBtn.textContent = "åˆªé™¤";
                        deleteBtn.style.marginLeft = "10px";
                        deleteBtn.onclick = function () {
                            const password = prompt("è«‹è¼¸å…¥å¯†ç¢¼ä»¥åˆªé™¤é ç´„ï¼š");
                            if (password === "Onano_Nb") {
                                remove(ref(db, `futureReservations/${key}`))
                                    .then(() => {
                                        alert("âœ… é ç´„å·²åˆªé™¤");
                                        loadFutureReservations();
                                    })
                                    .catch(err => {
                                        alert("âŒ åˆªé™¤å¤±æ•—ï¼š" + err);
                                    });
                            } else {
                                alert("å¯†ç¢¼éŒ¯èª¤ï¼");
                            }
                        };
                        li.appendChild(deleteBtn);
                    }
                    listElem.appendChild(li);
                });
            });
        }

        function monitorFutureReservations() {
            setInterval(() => {
                const now = new Date();
                const futureRef = ref(db, 'futureReservations');
                get(futureRef).then(snapshot => {
                    const data = snapshot.val();
                    if (!data) return;
                    Object.entries(data).forEach(([key, res]) => {
                        const startTime = new Date(res.startTime);
                        const endTime = new Date(res.endTime);
                        const roomId = res.roomId;
                        const cell = document.getElementById(roomId);

                        if (now >= startTime && cell && cell.classList.contains('green')) {
                            cell.classList.remove('green'); cell.classList.add('red');
                            cell.textContent = `${roomId} - ${res.user} - ${res.startTime} ~ ${res.endTime}`;
                            set(ref(db, roomId), { color: 'red', user: res.user, startTime: res.startTime, endTime: res.endTime });
                            push(recordsRef, { id: roomId, action: 'ä½¿ç”¨ä¸­ï¼ˆé ç´„è‡ªå‹•ï¼‰', user: res.user, startTime: res.startTime, endTime: res.endTime, time: new Date().toISOString() });
                        }
                        if (now >= endTime && cell && cell.classList.contains('red')) {
                            cell.classList.remove('red'); cell.classList.add('green');
                            cell.textContent = roomId;
                            set(ref(db, roomId), { color: 'green' });
                            push(recordsRef, { id: roomId, action: 'ç©ºé–’ï¼ˆé ç´„è‡ªå‹•ï¼‰', user: res.user, startTime: res.startTime, endTime: res.endTime, time: new Date().toISOString() });
                            remove(ref(db, `futureReservations/${key}`));
                        }
                    });
                });
            }, 10000);
        }

        // display date/time
        function displayDateTime() {
            const now = new Date();
            const options = { timeZone: 'Asia/Taipei', year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit', second: '2-digit', hour12:false };
            const dateTime = now.toLocaleString('zh-TW', options);
            const dt = document.getElementById('datetime');
            if (dt) dt.textContent = dateTime;
        }

        // expose loadFutureReservations for onload
        window.loadFutureReservations = loadFutureReservations;
        window.loadCarReservations = loadCarReservations;
        window.monitorCarReservations = monitorCarReservations;
        window.updateBlockStatus = updateBlockStatus;
        window.downloadCurrentHTML = downloadCurrentHTML;

    </script>

    <style>
        body { font-family: Arial, "æ¨™æ¥·é«”", serif; margin: 20px; background-image: url('https://i.meee.com.tw/445Ea5W.png'); background-size: cover; background-attachment: fixed; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        table, th, td { border: 1px solid #000; }
        th, td { padding: 10px; text-align: center; cursor: pointer; }
        .green { background-color: #28a745; color: white; font-weight: bold; }
        .red { background-color: #dc3545; color: white; font-weight: bold; }
        #systemImage { display:block; margin: 20px auto; max-width:10%; height:auto; }
        #newsTicker { background-color:#f8f9fa; padding:10px; text-align:center; font-size:18px; white-space:nowrap; overflow:hidden; }
        #newsTicker span { display:inline-block; padding-right:100%; animation: ticker 20s linear infinite; }
        @keyframes ticker { 0% { transform: translateX(100%);} 100% { transform: translateX(-100%);} }
        select, input[type="text"], button { margin: 6px 4px; padding:6px; }
        ul { list-style: none; padding-left: 0; }
        li { padding:6px; border-bottom:1px solid #ddd; }
    </style>
</head>
<body>
    <h1>æ‚…åŸå…¬å‹™è»Šé ç´„ç³»çµ±</h1>
    <div>
        <h2>ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦ é ç´„å…¬å‹™è»Š</h2>

        <label for="userSelect">é¸æ“‡ç”¨æˆ¶: </label>
        <select id="userSelect"><option value="">è«‹é¸æ“‡</option></select>
        <input type="text" id="customUserInput" placeholder="è«‹å…ˆé»é¸:å…¶ä»–~æ‰å¯è¼¸å…¥åç¨±" />

        <div style="margin-top:8px;">
            <label for="yearSelect">å¹´ä»½ï¼š</label><select id="yearSelect"></select>
            <label for="monthSelect">æœˆä»½ï¼š</label><select id="monthSelect"></select>
            <label for="daySelect">æ—¥æœŸï¼š</label><select id="daySelect"></select>
        </div>

        <div style="margin-top:8px;">
            <label>é–‹å§‹ï¼š</label>
            <select id="startHour"></select> : <select id="startMinute"></select>
            <label>çµæŸï¼š</label>
            <select id="endHour"></select> : <select id="endMinute"></select>
            <button onclick="applyCustomUserAndTime()">å¥—ç”¨</button>
            <p id="currentUserInfo" style="margin-top:10px;"></p>
        </div>
    </div>

    <div id="newsTicker"><span>æ³¨æ„äº‹é …: é ç´„è½è»Šè«‹å…ˆå¥—ç”¨ä½¿ç”¨è€…èˆ‡æ™‚é–“ï¼›ç®¡ç†è€…å¯åˆªé™¤é ç´„ã€‚</span></div>

    <h3>è½è»Š - ä¸€éµé ç´„ï¼ˆæœƒé¡¯ç¤ºåœ¨ä¸‹æ–¹æ¸…å–®ï¼‰</h3>
    <label for="carSelect">é¸æ“‡è»Šè¼›:</label>
    <select id="carSelect"></select>
    <button onclick="reserveCar()">é ç´„è½è»Š</button>

    <ul id="carReservationsList"></ul>

    <h3>è½è»ŠçŸ­æœŸç•¶ä¸‹ä½¿ç”¨å€ï¼ˆé»æ“Šæ ¼å­ç«‹å³åˆ‡æ›ç‹€æ…‹ï¼‰</h3>
    <table>
        <tr>
            <td id="4351-M5" data-type="car" class="green" onclick="toggleColor(this)">4351-M5</td>
        </tr>
    </table>

    <h3>ç´€éŒ„æª¢è¦–</h3>
    <label for="carNumberInput">æœå°‹é ç´„:</label>
    <input type="text" id="carNumberInput" value="">
    <button onclick="showRecords()">é¡¯ç¤ºç´€éŒ„</button>
    <ul id="recordList"></ul>

</body>
</html>
